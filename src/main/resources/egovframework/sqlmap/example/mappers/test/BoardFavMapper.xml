<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="egovframework.sth.domain.board.mapper.BoardFavMapper">

	<resultMap type="egovframework.sth.domain.board.domain.BoardFavDTO" id="BoardFavDTO"/>
	<resultMap type="egovframework.sth.domain.board.domain.BoardViewVO" id="BoardViewVO"/>
	
	<!-- 찜등록 -->
	<insert id="insFav">
		INSERT INTO fav
		(m_no, b_no)
		VALUES
		(#{m_no}, #{b_no})
	</insert>
	
	<!-- 찜여부 -->
	<select id="selFav" resultMap="BoardFavDTO">
		SELECT b_no, m_no
		FROM fav
		WHERE b_no = #{b_no}
		AND m_no = #{m_no}
	</select>
	
	<!-- 찜목록 -->
	<select id="selFavList" resultMap="BoardViewVO">
		SELECT B.b_no, B.b_title, B.b_dt, B.b_price, B.b_tt, B.b_enddt, B.m_no, 
		M.m_nickname AS b_writer,
		AN.an_type2 AS an_type2
		FROM board AS B
		INNER JOIN fav AS F
		ON B.b_no = F.b_no
		LEFT JOIN member AS M
		ON B.m_no = M.m_no
		LEFT JOIN animal_info AN
		ON B.b_no = AN.b_no
		WHERE F.m_no = #{m_no}
	</select>
	
	<delete id="delFav">
		DELETE FROM fav
		WHERE b_no = #{b_no}
		AND m_no = #{m_no}
	</delete>

</mapper>